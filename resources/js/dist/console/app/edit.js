"use strict";$(document).ready(function(){$(".article-heading").on("keyup change paste",function(){$(".breadcrumbs li:last-child > a").text($(".article-heading").text())}),$(".card-list").on("click",".remove-article-card-button",function(a){a.preventDefault(),$(a.target).closest("li").remove(),enableSave()}),$("#add-article-input").easyAutocomplete({url:"/api/v1/article/get/all",getValue:"title",list:{maxNumberOfElements:3,match:{enabled:!0},onChooseEvent:function(){$("#article").val(JSON.stringify($("#add-article-input").getSelectedItemData()))}},placeholder:"Search for an article...",requestDelay:200}),$("#add-article-input").on("keyup",function(a){a.preventDefault(),13==a.which&&$("#add-article-input").val().length&&(renderArticleItem(JSON.parse($("#article").val()),"article"),$("#add-article-input, #article").val(""))}),$("#add-article-button").click(function(a){a.preventDefault(),$("#article").val().length&&(renderArticleItem(JSON.parse($("#article").val()),"article"),$("#add-article-input, #article").val(""))}),$("#file").change(function(){if($("#img-changed").val("true"),$("#file")&&$("#file")[0]&&$("#file")[0].files&&$("#file")[0].files[0]){var a=new FileReader;a.onload=function(a){$("#file-img").css("background-image","url('".concat(a.target.result,"')"))},a.readAsDataURL($("#file")[0].files[0])}}),$(".button-save").click(function(a){if(a.preventDefault(),$(a.currentTarget).hasClass("disabled"))return!1;var b=$(".article-card-item").map(function(a,b){return $(b).data("articleid")}).toArray(),c=new FormData;c.append("title",$("#article-title").text()),c.append("descriptionShort",$("#article-summary").text()),c.append("link",$("#link").val()),c.append("idMyAppPhase",$("#phase").val());var d=!0,e=!1,f=void 0;try{for(var g,h,i=b[Symbol.iterator]();!(d=(g=i.next()).done);d=!0)h=g.value,c.append("articles[]",h)}catch(a){e=!0,f=a}finally{try{d||null==i.return||i.return()}finally{if(e)throw f}}"true"===$("#img-changed").val()&&c.append("fileupload",$("#file")[0].files[0]),$.ajax({url:$("#update-endpoint").val(),method:$("#update-method").val(),contentType:!1,processData:!1,data:c,success:function(a){disableSave(),a.created?window.location.replace("/app/"+a.app.id):$("#toast-save-success").addClass("show")},error:function(){$("#toast-save-error").addClass("show")}})}),$(".article, .console-modal").on("keyup change paste",":input, [contenteditable=true]",function(){$("#article-title").text().length?enableSave():disableSave()}),$(".article").on("click",".ce-settings__plugin-zone *, .ce-settings__default-zone *",function(){$("#article-title").text().length?enableSave():disableSave()}),$("#button-generate-preview").click(function(a){a.preventDefault(),$.ajax({url:"/api/v1/preview/create/one",method:"POST",data:{entity:"app",entityID:$("#app-id").val()},success:function(a){$("#preview-link").val(a.link),$("#modal-preview").foundation("open")},error:function(a){console.error(a)}})})});var renderArticleItem=function(a){var b=!1,c=!1;$(".article-card-item").each(function(){return $(this).data("articleid")==a.id?(c=!0,!1):$(this).find("h3").first().text()>a.title?(b=!0,$(this).before(articleItemToDOM(a,!0)),!1):void 0}),b||c||($(".article-card-item").length?$(".article-card-item").last().after(articleItemToDOM(a,!0)):$(".article-cards-wrapper").append(articleItemToDOM(a,!0)))},articleItemToDOM=function(a,b){return b=null!=b&&b,"<li data-articleid=\"".concat(a.id,"\" class=\"cell article-card-item\">\n  <a class=\"article-card\" href=\"#\">\n    <h3 class=\"article-card-title\">").concat(a.title,"</h3>\n    ").concat(b?"<button class='remove-article-card-button'><i class='fas fa-times-circle'></i></button>":"","\n  </a>\n  </li>")},enableSave=function(){$(".button-save").removeClass("disabled")},disableSave=function(){$(".button-save").addClass("disabled")};