"use strict";$(document).ready(function(){$("#location").val("null").change();var a=window.standardHoursData,b=window.specialHoursData,c=$("#hours-standard").DataTable({dom:"t",ordering:!1}),d=$("#hours-special").DataTable({dom:"t",ordering:!1});$("#location").change(function(){if($("#hours-standard-editable, #hours-special-editable").prop("checked",!1).change(),"null"===$("#location").val())reset(c,d);else{var e=a.filter(function(a){return a.idLocation==$("#location").val()});c.rows().every(function(){var a=this,b=e.find(function(b){return"hours-standard-day-".concat(b.idDayOfWeek)==a.id()});b?this.data([b.dayOfWeek.id,b.dayOfWeek.title,isClosedToInput(b.isClosed,"standard",!0),timeToInput(b.timeOpen,"standard",b.isClosed,!0),timeToInput(b.timeClosed,"standard",b.isClosed,!0)]):this.data([this.data()[0],this.data()[1],isClosedToInput(!1,"standard",!0),timeToInput("09:00:00","standard",!1,!0),timeToInput("17:00:00","standard",!1,!0)])});var f=b.filter(function(a){return a.idLocation==$("#location").val()});d.rows().remove();var g=!$("#hours-special-editable").is(":checked"),h=!0,i=!1,j=void 0;try{for(var k,l,m=f[Symbol.iterator]();!(h=(k=m.next()).done);h=!0)l=k.value,d.row.add([dateToInput(l.date,g),isClosedToInput(l.isClosed,"special",g),timeToInput(l.timeOpen,"special",l.isClosed,g),timeToInput(l.timeClosed,"special",l.isClosed,g)])}catch(a){i=!0,j=a}finally{try{h||null==m.return||m.return()}finally{if(i)throw j}}d.draw()}}),$("#hours-standard-editable").change(function(){$(".hours-standard-input").prop("disabled",!$("#hours-standard-editable").is(":checked"))}),$("#hours-special-editable").change(function(){$(".hours-special-input").prop("disabled",!$("#hours-special-editable").is(":checked"))}),$("#hours-special-add-row").click(function(a){a.preventDefault();var b=!$("#hours-special-editable").is(":checked");d.row.add([dateToInput("",b),isClosedToInput(!0,"special",b),timeToInput("09:00:00","special",!0,b),timeToInput("17:00:00","special",!0,b)]).draw()}),$(".table").on("change","input.hours-standard-input[type=checkbox], input.hours-special-input[type=checkbox]",function(){$(this).parent().siblings().children("input.hours-standard-input[type=time], input.hours-special-input[type=time]").toggle()}),$(".button-save").click(function(a){if(a.preventDefault(),"null"===$("#location").val())return!1;var b={},e=!0;c.rows().nodes().to$().each(function(){var a=$(this).find("td").first().text(),c=$(this).find(".hours-standard-input").eq(0).is(":checked"),d=$(this).find(".hours-standard-input").eq(1).val(),f=$(this).find(".hours-standard-input").eq(2).val(),g=moment.utc(d,"HH:mm:ss",!0),h=moment.utc(f,"HH:mm:ss",!0);g.isValid()&&h.isValid()&&!g.isAfter(h)||(e=!1),b["".concat(a)]={isClosed:c,timeOpen:d,timeClosed:f}});var f={};d.rows().nodes().to$().each(function(){var a=$(this).find(".hours-special-input").eq(0).val(),b=$(this).find(".hours-special-input").eq(1).is(":checked"),c=$(this).find(".hours-special-input").eq(2).val(),d=$(this).find(".hours-special-input").eq(3).val(),g=moment.utc(c,"HH:mm:ss",!0),h=moment.utc(d,"HH:mm:ss",!0);(!g.isValid()||!h.isValid()||g.isAfter(h)||"".concat(a)in f)&&(e=!1),f["".concat(a)]={isClosed:b,timeOpen:c,timeClosed:d}}),e?$.ajax({url:"/api/v1/location/hours/update/one/".concat($("#location").val()),method:"POST",data:{standardHours:JSON.stringify(b),specialHours:JSON.stringify(f)},success:function(){$("#toast-save-success").addClass("show")},error:function(){$("#toast-save-error").addClass("show")}}):$("#toast-invalid-times").addClass("show")})});var timeToInput=function(a,b,c,d){return"<input class='hours-".concat(b,"-input' type=\"time\" value=\"").concat(a,"\"").concat(d?" disabled":"").concat(c?" style=\"display: none\"":"",">")},dateToInput=function(a,b){return"<input class='hours-special-input' type=\"date\" value=\"".concat(a,"\"").concat(b?" disabled":"",">")},isClosedToInput=function(a,b,c){return"<td><input class='hours-".concat(b,"-input' type='checkbox'").concat(a?" checked":"").concat(c?" disabled":"","></td>")},reset=function(a,b){b.rows().remove().draw(),a.rows().every(function(){this.data([this.data()[0],this.data()[1],isClosedToInput(!1,"standard",!0),timeToInput("","standard",!1,!0),timeToInput("","standard",!1,!0)])})};