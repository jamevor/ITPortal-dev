"use strict";function asyncGeneratorStep(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){return void c(a)}h.done?b(i):Promise.resolve(i).then(d,e)}function _asyncToGenerator(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){function f(a){asyncGeneratorStep(h,d,e,f,g,"next",a)}function g(a){asyncGeneratorStep(h,d,e,f,g,"throw",a)}var h=a.apply(b,c);f(void 0)})}}$(document).ready(function(){var a=new EditorJS({holder:"roomNotes",placeholder:"Begin your description here...",minHeight:1,tools:{paragraph:{inlineToolbar:["bold","italic"]},header:{class:Header,config:{minHeader:3,maxHeader:6,defaultLevel:3}},list:{class:List,inlineToolbar:["bold","italic","inlineCode","outdent","indent","styleToggle"]},inlineCode:{class:InlineCode},indent:{class:ListIndent},outdent:{class:ListOutdent},styleToggle:{class:ListStyleToggle},image:{class:ImageTool,config:{field:"fileupload",endpoints:{byFile:"/api/v1/file-upload/create/one",byUrl:"/api/v1/file-upload/create/one"},additionalRequestData:{via:"editorjs"}}}},data:window.editorjs_initialize_data.roomNotes});$(".article-heading").on("keyup change paste",function(){$(".breadcrumbs li:last-child > a").text($(".article-heading").text())}),$("#add-tag-input").easyAutocomplete({url:"/api/v1/tag/get/all",getValue:"title",list:{maxNumberOfElements:2,match:{enabled:!0},onChooseEvent:function(){$("#tag").val(JSON.stringify($("#add-tag-input").getSelectedItemData()))}},requestDelay:200}),$("#add-tag-input").on("keyup",function(a){a.preventDefault(),13==a.which&&$("#add-tag-input").val().length&&(renderTag(JSON.parse($("#tag").val())),$("#add-tag-input, #tag").val(""))}),$(".tags").on("click",".remove-tag-button",function(a){a.preventDefault(),$(a.target).closest("li").remove(),enableSave()}),$("#add-audience-input").easyAutocomplete({url:"/api/v1/audience/get/all",getValue:"title",list:{maxNumberOfElements:2,match:{enabled:!0},onChooseEvent:function(){$("#audience").val(JSON.stringify($("#add-audience-input").getSelectedItemData()))}},requestDelay:200}),$("#add-audience-input").on("keyup",function(a){a.preventDefault(),13==a.which&&$("#add-audience-input").val().length&&(renderAudience(JSON.parse($("#audience").val())),$("#add-audience-input, #audience").val(""))}),$(".audience").on("click",".remove-audience-button",function(a){a.preventDefault(),$(a.target).closest("li").remove(),enableSave()}),$("#add-alias-input").easyAutocomplete({url:"/api/v1/alias/get/all",getValue:"title",list:{maxNumberOfElements:2,match:{enabled:!0},onChooseEvent:function(){$("#alias").val(JSON.stringify($("#add-alias-input").getSelectedItemData()))}},requestDelay:200}),$("#add-alias-input").on("keyup",function(a){a.preventDefault(),13==a.which&&$("#add-alias-input").val().length&&(renderAlias(JSON.parse($("#alias").val())),$("#add-alias-input, #alias").val(""))}),$(".alias").on("click",".remove-alias-button",function(a){a.preventDefault(),$(a.target).closest("li").remove(),enableSave()}),$("#add-software-input").easyAutocomplete({url:"/api/v1/software/get/all",getValue:"title",list:{maxNumberOfElements:3,match:{enabled:!0},onChooseEvent:function(){$("#software").val(JSON.stringify($("#add-software-input").getSelectedItemData()))}},placeholder:"Search for software...",requestDelay:200}),$("#add-software-button").click(function(a){a.preventDefault(),$("#software").val().length&&(renderSoftware(JSON.parse($("#software").val())),$("#add-software-input, #software").val(""))}),$("#softwareTable tbody").on("click",".button-remove-software",function(a){window.softwareTable.row($(a.currentTarget).closest("tr")).remove(),window.softwareTable.draw(),enableSave()}),$(".building-cards-wrapper").on("click",".remove-catalog-item-button",function(a){a.preventDefault(),$(a.target).closest("li").remove(),$("#relate-building-input-group").slideDown(),$(".breadcrumbs li:nth-last-child(2) > a").text(""),$("#building-address").text(""),$("#building-common a").text(""),enableSave()}),$("#relate-building-input").easyAutocomplete({url:"/api/v1/building/get/all",getValue:"title",list:{maxNumberOfElements:3,match:{enabled:!0},onChooseEvent:function(){$("#building").val(JSON.stringify($("#relate-building-input").getSelectedItemData()))}},placeholder:"Search for a building...",requestDelay:200}),$("#relate-building-input").on("keyup",function(a){a.preventDefault(),13==a.which&&$("#relate-building-input").val().length&&(renderParentBuilding(JSON.parse($("#building").val()),"building"),$("#relate-building-input, #building").val(""))}),$("#relate-building-button").click(function(a){a.preventDefault(),$("#building").val().length&&(renderParentBuilding(JSON.parse($("#building").val()),"building"),$("#relate-building-input, #building").val(""))}),$(".console-modal").on("click",".remove-related-item-button",function(a){a.preventDefault(),$(a.target).closest("li").remove(),enableSave()}),$("#add-package-input").easyAutocomplete({url:"/api/v1/package/get/all",getValue:"title",list:{maxNumberOfElements:3,match:{enabled:!0},onChooseEvent:function(){$("#package").val(JSON.stringify($("#add-package-input").getSelectedItemData()))}},placeholder:"Search for a package...",requestDelay:200}),$("#add-package-button").click(function(a){a.preventDefault(),$("#package").val().length&&(addRelationshipItem(JSON.parse($("#package").val()),"package"),$("#package","#add-package-input").val(""))}),$(".console-modal").on("click",".remove-related-item-button",function(a){a.preventDefault(),$(a.target).closest("li").remove(),enableSave()}),$(".button-save").click(function(){var b=_asyncToGenerator(regeneratorRuntime.mark(function b(c){var d,e,f,g,h,i;return regeneratorRuntime.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(c.preventDefault(),!$(c.currentTarget).hasClass("disabled")){b.next=3;break}return b.abrupt("return",!1);case 3:return d=$(".tags").children("li.tag").map(function(a,b){return $(b).data("tagid")}).toArray(),e=$(".audience").children("li.audience-item").map(function(a,b){return $(b).data("audienceid")}).toArray(),f=$(".alias").children("li.alias-item").map(function(a,b){return $(b).data("aliasid")}).toArray(),g=window.softwareTable.columns(0).data().eq(0).unique().toArray(),h=$(".packages-wrapper").children("li.package-item").map(function(a,b){return $(b).data("packageid")}).toArray(),i=$(".building-card-item").first().data("buildingid")||null,b.t0=$,b.t1=$("#update-endpoint").val(),b.t2=$("#update-method").val(),b.t3=$("#article-title").text(),b.t4=$("#article-summary").text(),b.next=16,a.save();case 16:b.t5=b.sent,b.t6=$("#locationType").val(),b.t7=$("#hasPrinter").is(":checked"),b.t8=$("#hasColorPrinter").is(":checked"),b.t9=$("#hasPharos").is(":checked"),b.t10=$("#hasProjection").is(":checked"),b.t11=$("#hasDualProjection").is(":checked"),b.t12=$("#hasDocCamera").is(":checked"),b.t13=$("#hasLectureCap").is(":checked"),b.t14=$("#hasVoiceAmp").is(":checked"),b.t15=$("#hasWirelessVoiceAmp").is(":checked"),b.t16=$("#hasPOD").is(":checked"),b.t17=$("#hasDisplay").is(":checked"),b.t18=$("#hasHostPC").is(":checked"),b.t19=$("#room").text(),b.t20=$("#seats").val(),b.t21=$("#computers").val(),b.t22=i,b.t23=d,b.t24=e,b.t25=f,b.t26=g,b.t27=h,b.t28={title:b.t3,descriptionShort:b.t4,roomNotes:b.t5,idLocationType:b.t6,hasPrinter:b.t7,hasColorPrinter:b.t8,hasPharos:b.t9,hasProjection:b.t10,hasDualProjection:b.t11,hasDocCamera:b.t12,hasLectureCap:b.t13,hasVoiceAmp:b.t14,hasWirelessVoiceAmp:b.t15,hasPOD:b.t16,hasDisplay:b.t17,hasHostPC:b.t18,room:b.t19,seats:b.t20,computers:b.t21,idBuilding:b.t22,tags:b.t23,audiences:b.t24,aliases:b.t25,software:b.t26,packages:b.t27},b.t29=function(a){disableSave(),a.created?window.location.replace("/location/"+a.location.id):$("#toast-save-success").addClass("show")},b.t30=function(){$("#toast-save-error").addClass("show")},b.t31={url:b.t1,method:b.t2,data:b.t28,success:b.t29,error:b.t30},b.t0.ajax.call(b.t0,b.t31);case 44:case"end":return b.stop();}},b)}));return function(){return b.apply(this,arguments)}}()),$(".article, .console-modal").on("keyup change paste",":input, [contenteditable=true]",function(){$("#article-title").text().length?enableSave():disableSave()}),$(".article").on("click",".ce-settings__plugin-zone *, .ce-settings__default-zone *",function(){$("#article-title").text().length?enableSave():disableSave()}),$("#button-generate-preview").click(function(a){a.preventDefault(),$.ajax({url:"/api/v1/preview/create/one",method:"POST",data:{entity:"location",entityID:$("#location-id").val()},success:function(a){$("#preview-link").val(a.link),$("#modal-preview").foundation("open")},error:function(a){console.error(a)}})})});var renderTag=function(a){var b=!1,c=!1;$(".tags").children(".tag").each(function(){return $(this).data("tagid")==a.id?(c=!0,!1):$(this).children("a").text()>a.title?(b=!0,$(this).before(tagToDOM(a)),!1):void 0}),b||c||($(".tags").children(".tag").length?$(".tags").children(".tag").last().before(tagToDOM(a)):$(".tags").children().last().before(tagToDOM(a)))},tagToDOM=function(a){return"<li data-tagid=\"".concat(a.id,"\" class=\"tag\"><a href=\"#\">").concat(a.title,"<button class='remove-tag-button'><i class='fas fa-times-circle'></i></button></a></li>")},renderAudience=function(a){var b=!1,c=!1;$(".audience").children(".audience-item").each(function(){return $(this).data("audienceid")==a.id?(c=!0,!1):$(this).children("a").text()>a.title?(b=!0,$(this).before(audienceToDOM(a)),!1):void 0}),b||c||($(".audience").children(".audience-item").length?$(".audience").children(".audience-item").last().before(audienceToDOM(a)):$(".audience").children().last().before(audienceToDOM(a)))},audienceToDOM=function(a){return"<li data-audienceid=\"".concat(a.id,"\" class=\"audience-item\"><a href=\"#\">").concat(a.title,"<button class='remove-audience-button'><i class='fas fa-times-circle'></i></button></a></li>")},renderAlias=function(a){var b=!1,c=!1;$(".alias").children(".alias-item").each(function(){return $(this).data("aliasid")==a.id?(c=!0,!1):$(this).children("a").text()>a.title?(b=!0,$(this).before(aliasToDOM(a)),!1):void 0}),b||c||($(".alias").children(".alias-item").length?$(".alias").children(".alias-item").last().before(aliasToDOM(a)):$(".alias").children().last().before(aliasToDOM(a)))},aliasToDOM=function(a){return"<li data-aliasid=\"".concat(a.id,"\" class=\"alias-item\"><a href=\"#\">").concat(a.title,"<button class='remove-alias-button'><i class='fas fa-times-circle'></i></button></a></li>")},renderSoftware=function(a){var b=!1;window.softwareTable.rows().every(function(){if(this.data()[0]==a.id)return b=!0,!1}),b||(window.softwareTable.row.add([a.id,a.title?"<a href='#'>".concat(a.title,"</a>"):"",a.version?a.version:"",a.publisher?a.publisher:"","<button class='button-remove-software'><i class='fas fa-unlink'></i> Remove</button>"]),window.softwareTable.draw())},catalogItemToDOM=function(a,b,c,d){return c=null!=c&&c,"<li data-".concat(b,"id=\"").concat(a.id,"\" class=\"cell ").concat(b,"-card-item").concat(d?" compact":"","\">\n    <a class=\"service-card\" href=\"#\">\n      <i class=\"service-card-icon fas ").concat(a.icon,"\"></i>\n      <h3 class=\"service-card-title\">").concat(a.title,"</h3>\n      ").concat(c?"<button class='remove-catalog-item-button'><i class='fas fa-times-circle'></i></button>":"","\n    </a>\n  </li>")},renderParentBuilding=function(a,b){$("#relate-building-input-group").slideUp(),$(".".concat(b,"-card-item")).remove(),$(".".concat(b,"-cards-wrapper")).append(catalogItemToDOM(a,b,!0,!0)),$(".breadcrumbs li:nth-last-child(2) > a").text(a.title),$("#building-address").text(a.address),$("#building-common a").text(a.common)},addRelationshipItem=function(a,b){var c=!1,d=!1;$(".".concat(b,"-item")).each(function(){return $(this).data("".concat(b,"id"))==a.id?(d=!0,!1):$(this).text()>a.title?(c=!0,$(this).before(relatedItemToDOM(a,b)),!1):void 0}),c||d||($(".".concat(b,"-item")).length?$(".".concat(b,"-item")).last().after(relatedItemToDOM(a,b)):$(".".concat(b,"s-wrapper")).append(relatedItemToDOM(a,b)))},relatedItemToDOM=function(a,b){return"<li data-".concat(b,"id=\"").concat(a.id,"\" class=\"").concat(b,"-item related-item\">").concat(a.title,"<button class='remove-related-item-button'><i class='fas fa-times'></i> Remove</button></li>")},enableSave=function(){$(".button-save").removeClass("disabled")},disableSave=function(){$(".button-save").addClass("disabled")};