"use strict";function asyncGeneratorStep(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){return void c(a)}h.done?b(i):Promise.resolve(i).then(d,e)}function _asyncToGenerator(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){function f(a){asyncGeneratorStep(h,d,e,f,g,"next",a)}function g(a){asyncGeneratorStep(h,d,e,f,g,"throw",a)}var h=a.apply(b,c);f(void 0)})}}$(document).ready(function(){var a={paragraph:{inlineToolbar:["bold","italic"]},header:{class:Header,config:{minHeader:2,maxHeader:6,defaultLevel:2}},list:{class:List,inlineToolbar:["bold","italic","inlineCode","outdent","indent","styleToggle"]},inlineCode:{class:InlineCode},indent:{class:ListIndent},outdent:{class:ListOutdent},styleToggle:{class:ListStyleToggle},image:{class:ImageTool,config:{field:"fileupload",endpoints:{byFile:"/api/v1/file-upload/create/one",byUrl:"/api/v1/file-upload/create/one"},additionalRequestData:{via:"editorjs"}}},code:{class:CodeTool},note:{class:Note,inlineToolbar:["bold","italic","inlineCode"],config:{titlePlaceholder:"Note Title",messagePlaceholder:"Note Message"}}},b=new EditorJS({holder:"articleMain",placeholder:"Begin your article here...",tools:a,data:window.editorjs_initialize_data.articleMain}),c=new EditorJS({holder:"articleAdvanced",placeholder:"Begin your article here...",tools:a,data:window.editorjs_initialize_data.articleAlternate}),d=new EditorJS({holder:"articleInternal",placeholder:"Begin your article here...",tools:a,data:window.editorjs_initialize_data.articleInternal});$("#file").change(function(){if($("#img-changed").val("true"),$("#button-remove-image").show(),$("#img-removed").val("false"),$("#file")&&$("#file")[0]&&$("#file")[0].files&&$("#file")[0].files[0]){var a=new FileReader;a.onload=function(a){$(".section-img").css("background-image","url('".concat(a.target.result,"')"))},a.readAsDataURL($("#file")[0].files[0])}enableSave()}),$("#button-remove-image").click(function(a){a.preventDefault(),$(".section-img").css("background-image",""),$("#button-remove-image").hide(),$("#img-removed").val("true"),enableSave()}),$(".article-heading").on("keyup change paste",function(){$(".breadcrumbs li:last-child > a").text($(".article-heading").text())}),$("#actionTitle").easyAutocomplete({url:"/api/v1/action/get/all",getValue:"title",list:{maxNumberOfElements:2,match:{enabled:!0},onChooseEvent:function(){$("#action").val(JSON.stringify($("#actionTitle").getSelectedItemData()))},showAnimation:{type:"slide",time:300,callback:function(){}},hideAnimation:{type:"slide",time:300,callback:function(){}}},template:{type:"custom",method:function(a,b){return actionToDOM(b,!1)}},placeholder:"Search for an action...",requestDelay:200}),$("#add-action-button").click(function(a){a.preventDefault(),$("#action").val().length&&(renderAction(JSON.parse($("#action").val())),$("#action, #actionTitle").val(""))}),$("#link-cards-action").on("click",".remove-action-button",function(a){a.preventDefault(),$(a.target).closest("li").remove(),enableSave()}),$("#add-tag-input").easyAutocomplete({url:"/api/v1/tag/get/all",getValue:"title",list:{maxNumberOfElements:2,match:{enabled:!0},onChooseEvent:function(){$("#tag").val(JSON.stringify($("#add-tag-input").getSelectedItemData()))}},requestDelay:200}),$("#add-tag-input").on("keyup",function(a){a.preventDefault(),13==a.which&&$("#add-tag-input").val().length&&(renderTag(JSON.parse($("#tag").val())),$("#add-tag-input, #tag").val(""))}),$(".tags").on("click",".remove-tag-button",function(a){a.preventDefault(),$(a.target).closest("li").remove(),enableSave()}),$("#add-audience-input").easyAutocomplete({url:"/api/v1/audience/get/all",getValue:"title",list:{maxNumberOfElements:2,match:{enabled:!0},onChooseEvent:function(){$("#audience").val(JSON.stringify($("#add-audience-input").getSelectedItemData()))}},requestDelay:200}),$("#add-audience-input").on("keyup",function(a){a.preventDefault(),13==a.which&&$("#add-audience-input").val().length&&(renderAudience(JSON.parse($("#audience").val())),$("#add-audience-input, #audience").val(""))}),$(".audience").on("click",".remove-audience-button",function(a){a.preventDefault(),$(a.target).closest("li").remove(),enableSave()}),$(".link-cards").on("click",".remove-catalog-item-button",function(a){a.preventDefault(),$(a.target).closest("li").remove(),enableSave()}),$("#add-service-input").easyAutocomplete({url:"/api/v1/service/get/all",getValue:"title",list:{maxNumberOfElements:2,match:{enabled:!0},onChooseEvent:function(){$("#service").val(JSON.stringify($("#add-service-input").getSelectedItemData()))}},template:{type:"custom",method:function(a,b){return catalogItemToDOM(b,"service",!1,!0)}},placeholder:"Search for a service...",requestDelay:200}),$("#add-service-input").on("keyup",function(a){a.preventDefault(),13==a.which&&$("#add-service-input").val().length&&(renderCatalogItem(JSON.parse($("#service").val()),"service"),$("#add-service-input, #service").val(""))}),$("#add-service-button").click(function(a){a.preventDefault(),$("#service").val().length&&(renderCatalogItem(JSON.parse($("#service").val()),"service"),$("#add-service-input, #service").val(""))}),$("#add-component-input").easyAutocomplete({url:"/api/v1/component/get/all",getValue:"title",list:{maxNumberOfElements:2,match:{enabled:!0},onChooseEvent:function(){$("#component").val(JSON.stringify($("#add-component-input").getSelectedItemData()))}},template:{type:"custom",method:function(a,b){return catalogItemToDOM(b,"component",!1,!0)}},placeholder:"Search for a component...",requestDelay:200}),$("#add-component-input").on("keyup",function(a){a.preventDefault(),13==a.which&&$("#add-component-input").val().length&&(renderCatalogItem(JSON.parse($("#component").val()),"component"),$("#add-component-input, #component").val(""))}),$("#add-component-button").click(function(a){a.preventDefault(),$("#component").val().length&&(renderCatalogItem(JSON.parse($("#component").val()),"component"),$("#add-component-input, #component").val(""))}),$("#add-software-input").easyAutocomplete({url:"/api/v1/software/get/all",getValue:"title",list:{maxNumberOfElements:2,match:{enabled:!0},onChooseEvent:function(){$("#software").val(JSON.stringify($("#add-software-input").getSelectedItemData()))}},template:{type:"custom",method:function(a,b){return catalogItemToDOM(b,"software",!1)}},placeholder:"Search for software...",requestDelay:200}),$("#add-software-input").on("keyup",function(a){a.preventDefault(),13==a.which&&$("#add-software-input").val().length&&(renderCatalogItem(JSON.parse($("#software").val()),"software"),$("#add-software-input, #software").val(""))}),$("#add-software-button").click(function(a){a.preventDefault(),$("#software").val().length&&(renderCatalogItem(JSON.parse($("#software").val()),"software"),$("#add-software-input, #software").val(""))}),$(".button-save").click(function(){var a=_asyncToGenerator(regeneratorRuntime.mark(function a(e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(e.preventDefault(),!$(e.currentTarget).hasClass("disabled")){a.next=3;break}return a.abrupt("return",!1);case 3:return f=$("#link-cards-action").children("li").map(function(a,b){return $(b).data("actionid")}).toArray(),g=$(".tags").children("li.tag").map(function(a,b){return $(b).data("tagid")}).toArray(),h=$(".audience").children("li.audience-item").map(function(a,b){return $(b).data("audienceid")}).toArray(),i=$(".service-item").not(".ignore").map(function(a,b){return $(b).data("serviceid")}).toArray(),j=$(".component-item").not(".ignore").map(function(a,b){return $(b).data("componentid")}).toArray(),k=$(".software-item").map(function(a,b){return $(b).data("softwareid")}).toArray(),l=new FormData,l.append("title",$("#article-title").text()),l.append("descriptionShort",$("#article-summary").text()),l.append("idArticlePhase",$("#phase").val()),l.append("requireAuth",$("#requireAuth").is(":checked")),a.t0=l,a.t1=JSON,a.next=18,b.save();case 18:return a.t2=a.sent,a.t3=a.t1.stringify.call(a.t1,a.t2),a.t0.append.call(a.t0,"content",a.t3),a.t4=l,a.t5=JSON,a.next=25,c.save();case 25:return a.t6=a.sent,a.t7=a.t5.stringify.call(a.t5,a.t6),a.t4.append.call(a.t4,"contentAlt",a.t7),a.t8=l,a.t9=JSON,a.next=32,d.save();case 32:for(a.t10=a.sent,a.t11=a.t9.stringify.call(a.t9,a.t10),a.t8.append.call(a.t8,"contentInternal",a.t11),l.append("useLegacy",$("#useLegacy").is(":checked")),l.append("contentLegacy",$("#contentLegacy").val()),l.append("contentAltLegacy",$("#contentAltLegacy").val()),l.append("contentInternalLegacy",$("#contentInternalLegacy").val()),m=!0,n=!1,o=void 0,a.prev=42,p=f[Symbol.iterator]();!(m=(q=p.next()).done);m=!0)r=q.value,l.append("actions[]",r);a.next=50;break;case 46:a.prev=46,a.t12=a["catch"](42),n=!0,o=a.t12;case 50:a.prev=50,a.prev=51,m||null==p.return||p.return();case 53:if(a.prev=53,!n){a.next=56;break}throw o;case 56:return a.finish(53);case 57:return a.finish(50);case 58:for(s=!0,t=!1,u=void 0,a.prev=61,v=g[Symbol.iterator]();!(s=(w=v.next()).done);s=!0)x=w.value,l.append("tags[]",x);a.next=69;break;case 65:a.prev=65,a.t13=a["catch"](61),t=!0,u=a.t13;case 69:a.prev=69,a.prev=70,s||null==v.return||v.return();case 72:if(a.prev=72,!t){a.next=75;break}throw u;case 75:return a.finish(72);case 76:return a.finish(69);case 77:for(y=!0,z=!1,A=void 0,a.prev=80,B=h[Symbol.iterator]();!(y=(C=B.next()).done);y=!0)D=C.value,l.append("audiences[]",D);a.next=88;break;case 84:a.prev=84,a.t14=a["catch"](80),z=!0,A=a.t14;case 88:a.prev=88,a.prev=89,y||null==B.return||B.return();case 91:if(a.prev=91,!z){a.next=94;break}throw A;case 94:return a.finish(91);case 95:return a.finish(88);case 96:for(E=!0,F=!1,G=void 0,a.prev=99,H=i[Symbol.iterator]();!(E=(I=H.next()).done);E=!0)J=I.value,l.append("services[]",J);a.next=107;break;case 103:a.prev=103,a.t15=a["catch"](99),F=!0,G=a.t15;case 107:a.prev=107,a.prev=108,E||null==H.return||H.return();case 110:if(a.prev=110,!F){a.next=113;break}throw G;case 113:return a.finish(110);case 114:return a.finish(107);case 115:for(K=!0,L=!1,M=void 0,a.prev=118,N=j[Symbol.iterator]();!(K=(O=N.next()).done);K=!0)P=O.value,l.append("components[]",P);a.next=126;break;case 122:a.prev=122,a.t16=a["catch"](118),L=!0,M=a.t16;case 126:a.prev=126,a.prev=127,K||null==N.return||N.return();case 129:if(a.prev=129,!L){a.next=132;break}throw M;case 132:return a.finish(129);case 133:return a.finish(126);case 134:for(Q=!0,R=!1,S=void 0,a.prev=137,T=k[Symbol.iterator]();!(Q=(U=T.next()).done);Q=!0)V=U.value,l.append("softwares[]",V);a.next=145;break;case 141:a.prev=141,a.t17=a["catch"](137),R=!0,S=a.t17;case 145:a.prev=145,a.prev=146,Q||null==T.return||T.return();case 148:if(a.prev=148,!R){a.next=151;break}throw S;case 151:return a.finish(148);case 152:return a.finish(145);case 153:"true"===$("#img-changed").val()&&l.append("fileupload",$("#file")[0].files[0]),l.append("imageRemoved",$("#img-removed").val()),$.ajax({url:$("#update-endpoint").val(),method:$("#update-method").val(),contentType:!1,processData:!1,data:l,success:function(a){disableSave(),a.created?window.location.replace("/article/"+a.article.id):$("#toast-save-success").addClass("show")},error:function(){$("#toast-save-error").addClass("show")}});case 156:case"end":return a.stop();}},a,null,[[42,46,50,58],[51,,53,57],[61,65,69,77],[70,,72,76],[80,84,88,96],[89,,91,95],[99,103,107,115],[108,,110,114],[118,122,126,134],[127,,129,133],[137,141,145,153],[146,,148,152]])}));return function(){return a.apply(this,arguments)}}()),$(".article, .console-modal").on("keyup change paste",":input, [contenteditable=true]",function(){$("#article-title").text().length?enableSave():disableSave()}),$(".article").on("click",".ce-settings__plugin-zone *, .ce-settings__default-zone *",function(){$("#article-title").text().length?enableSave():disableSave()}),$("#button-generate-preview").click(function(a){a.preventDefault(),$.ajax({url:"/api/v1/preview/create/one",method:"POST",data:{entity:"article",entityID:$("#article-id").val()},success:function(a){$("#preview-link").val(a.link),$("#modal-preview").foundation("open")},error:function(a){console.error(a)}})})});var renderAction=function(a){var b=!1,c=!1;$("#link-cards-action").children().each(function(){return $(this).data("actionid")==a.id?(c=!0,!1):$(this).text()>a.title?(b=!0,$(this).before(actionToDOM(a,!1,!0)),!1):void 0}),b||c||$("#link-cards-action").append(actionToDOM(a,!1,!0))},actionToDOM=function(a,b,c){return b=null==b||b,c=null!=c&&c,"<li data-actionid=\"".concat(a.id,"\"><a class=\"").concat(a.actionType.title,"\" target=\"_self\" href=\"").concat(b?a.link:"#","\">").concat(a.title).concat(c?"<button class='remove-action-button'><i class='fas fa-times-circle'></i></button>":"","</a></li>")},renderTag=function(a){var b=!1,c=!1;$(".tags").children(".tag").each(function(){return $(this).data("tagid")==a.id?(c=!0,!1):$(this).children("a").text()>a.title?(b=!0,$(this).before(tagToDOM(a)),!1):void 0}),b||c||($(".tags").children(".tag").length?$(".tags").children(".tag").last().before(tagToDOM(a)):$(".tags").children().last().before(tagToDOM(a)))},tagToDOM=function(a){return"<li data-tagid=\"".concat(a.id,"\" class=\"tag\"><a href=\"#\">").concat(a.title,"<button class='remove-tag-button'><i class='fas fa-times-circle'></i></button></a></li>")},renderAudience=function(a){var b=!1,c=!1;$(".audience").children(".audience-item").each(function(){return $(this).data("audienceid")==a.id?(c=!0,!1):$(this).children("a").text()>a.title?(b=!0,$(this).before(audienceToDOM(a)),!1):void 0}),b||c||($(".audience").children(".audience-item").length?$(".audience").children(".audience-item").last().before(audienceToDOM(a)):$(".audience").children().last().before(audienceToDOM(a)))},audienceToDOM=function(a){return"<li data-audienceid=\"".concat(a.id,"\" class=\"audience-item\"><a href=\"#\">").concat(a.title,"<button class='remove-audience-button'><i class='fas fa-times-circle'></i></button></a></li>")},renderCatalogItem=function(a,b){var c=!1,d=!1;$(".catalog-items > li.".concat(b,"-item")).each(function(){return $(this).data("".concat(b,"id"))==a.id?(d=!0,!1):$(this).children("a").text()>a.title?(c=!0,$(this).before(catalogItemToDOM(a,b,!0)),!1):void 0}),c||d||($(".catalog-items > li.".concat(b,"-item")).length?$(".catalog-items > li.".concat(b,"-item")).last().after(catalogItemToDOM(a,b,!0)):$("#add-".concat(b,"-input")).closest("li").after(catalogItemToDOM(a,b,!0)))},catalogItemToDOM=function(a,b,c,d){return c=null!=c&&c,d=null!=d&&d,"<li data-".concat(b,"id=\"").concat(a.id,"\" class=\"").concat(b,"-item").concat(d?" ignore":"","\"><a class=\"catalog\" href=\"#\">").concat(a.title).concat(c?"<button class='remove-catalog-item-button'><i class='fas fa-times-circle'></i></button>":"","</a></li>")},enableSave=function(){$(".button-save").removeClass("disabled")},disableSave=function(){$(".button-save").addClass("disabled")};