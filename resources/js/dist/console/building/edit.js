"use strict";$(document).ready(function(){$(".article-heading").on("keyup change paste",function(){$(".breadcrumbs li:last-child > a").text($(".article-heading").text())}),$(".card-list").on("click",".remove-catalog-item-button",function(a){a.preventDefault(),$(a.target).closest("li").remove(),enableSave()}),$("#add-location-input").easyAutocomplete({url:"/api/v1/location/get/all",getValue:"title",list:{maxNumberOfElements:3,match:{enabled:!0},onChooseEvent:function(){$("#location").val(JSON.stringify($("#add-location-input").getSelectedItemData()))}},placeholder:"Search for a location...",requestDelay:200}),$("#add-location-input").on("keyup",function(a){a.preventDefault(),13==a.which&&$("#add-location-input").val().length&&(renderLocation(JSON.parse($("#location").val())),$("#add-location-input, #location").val(""))}),$("#add-location-button").click(function(a){a.preventDefault(),$("#location").val().length&&(renderLocation(JSON.parse($("#location").val())),$("#location, #location").val(""))}),$(".button-save").click(function(a){if(a.preventDefault(),$(a.currentTarget).hasClass("disabled"))return!1;var b=$(".location-item").map(function(a,b){return $(b).data("locationid")}).toArray();$.ajax({url:$("#update-endpoint").val(),method:$("#update-method").val(),data:{title:$("#article-title").text(),abbr:$("#abbr").text(),common:$("#building-common").text(),address:$("#building-address").text(),locations:b},success:function(a){disableSave(),a.created?window.location.replace("/building/"+a.building.id):$("#toast-save-success").addClass("show")},error:function(){$("#toast-save-error").addClass("show")}})}),$(".article, .console-modal").on("keyup change paste",":input, [contenteditable=true]",function(){$("#article-title").text().length?enableSave():disableSave()}),$(".article").on("click",".ce-settings__plugin-zone *, .ce-settings__default-zone *",function(){$("#article-title").text().length?enableSave():disableSave()}),$("#button-generate-preview").click(function(a){a.preventDefault(),$.ajax({url:"/api/v1/preview/create/one",method:"POST",data:{entity:"building",entityID:$("#building-id").val()},success:function(a){$("#preview-link").val(a.link),$("#modal-preview").foundation("open")},error:function(a){console.error(a)}})})});var renderLocation=function(a){var b=!1,c=!1;$(".location-item").each(function(){return $(this).data("locationid")==a.id?(c=!0,!1):$(this).text()>a.title?(b=!0,$(this).before(locationToDOM(a)),!1):void 0}),b||c||($(".location-item").length?$(".location-item").last().after(locationToDOM(a)):$(".locations-wrapper").append(locationToDOM(a)))},locationToDOM=function(a){return"\n  <li class=\"cell location-item\" data-locationid=\"".concat(a.id,"\">\n    <a class=\"location-card\" href=\"#\">\n      <i class=\"location-card-icon fas ").concat(a.locationType&&a.locationType.icon?a.locationType.icon:"fa-globe","\"></i>\n      <h3 class=\"location-card-title\">").concat(a.title,"</h3>\n      <p class=\"location-card-room\">").concat(a.room,"</p>\n    </a>\n  </li>\n  ")},enableSave=function(){$(".button-save").removeClass("disabled")},disableSave=function(){$(".button-save").addClass("disabled")};